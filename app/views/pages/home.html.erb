<div class="container mx-auto px-6 pb-10">
  <h1 class="text-4xl mb-8">Hello,
    <%= @name || "Pedro" %>.</h1>

  <h2 class="text-2xl mb-6">You are reading the following books:</h2>

  <div class="space-y-8">
    <% @library[:books].each do |book| %>
      <div class="card bg-base-100 shadow-md lg:card-side">
        <!-- Cover -->
        <figure class="lg:w-1/4">
          <img
            src="<%= book[:cover_url] %>"
            alt="<%= "#{book[:title]} cover" %>"
            class="h-full w-full object-cover"
          />
        </figure>
        <!-- Content -->
        <div class="card-body lg:w-2/3 gap-3">
          <div class="flex items-start justify-between gap-4">
            <div>
              <h3 class="text-xl leading-tight"><%= book[:title] %></h3>
              <p class="opacity-70 text-sm"><%= book[:author] %></p>
            </div>
            <div class="flex flex-wrap gap-2">
              <span class="badge badge-outline"><%= book[:category] %></span>
              <span class="badge badge-outline"><%= book[:reading_method].to_s.capitalize %></span>
            </div>
          </div>
          <!-- Tags -->
          <div class="flex flex-wrap gap-2">
            <% book[:tags].each do |tag| %>
              <span class="badge badge-ghost"><%= tag %></span>
            <% end %>
          </div>
          <!-- Pace phrase -->
          <p class="italic opacity-80"><%= book[:pace_phrase] %></p>
          <!-- Progress -->
          <% current_page = book[:progress][:current_page]
          total_pages = book[:progress][:total_pages]
          percent =
            (book[:progress][:percent] || (current_page.to_f / total_pages * 100)).round %>
          <div class="space-y-2">
            <div class="flex items-center justify-between text-sm">
              <span>Progress:
                <strong><%= current_page %></strong>/<%= total_pages %>
                pages</span>
              <span class="opacity-70"><%= percent %>%</span>
            </div>
            <progress
              class="progress progress-primary w-full"
              value="<%= percent %>"
              max="100"
            ></progress>
          </div>
          <!-- Update section (note + sentiment + page) -->
          <form class="mt-2 space-y-2">
            <!-- Quick note -->
            <label class="form-control w-full">
              <div class="label justify-between">
                <span class="label-text">Quick note (optional)</span>
                <span class="label-text-alt opacity-70">Max 200 chars</span>
              </div>
              <textarea
                class="
                  textarea textarea-bordered textarea-sm w-full min-h-24 resize-y
                "
                rows="3"
                maxlength="200"
                placeholder="A sentence about how it's going…"
              ></textarea>
            </label>
            <!-- Semantic feedback -->
            <div class="mt-2">
              <div class="label"><span class="label-text">How’s it going?</span></div>
              <div class="join join-vertical sm:join-horizontal">
                <input
                  class="btn btn-sm join-item"
                  type="radio"
                  name="sentiment_<%= book[:id] %>"
                  aria-label="Boring"
                  value="boring"
                />
                <input
                  class="btn btn-sm join-item"
                  type="radio"
                  name="sentiment_<%= book[:id] %>"
                  aria-label="Meh"
                  value="meh"
                />
                <input
                  class="btn btn-sm join-item"
                  type="radio"
                  name="sentiment_<%= book[:id] %>"
                  aria-label="Good"
                  value="good"
                />
                <input
                  class="btn btn-sm join-item"
                  type="radio"
                  name="sentiment_<%= book[:id] %>"
                  aria-label="Interesting"
                  value="interesting"
                />
                <input
                  class="btn btn-sm join-item"
                  type="radio"
                  name="sentiment_<%= book[:id] %>"
                  aria-label="Gripping"
                  value="gripping"
                />
                <input
                  class="btn btn-sm join-item"
                  type="radio"
                  name="sentiment_<%= book[:id] %>"
                  aria-label="Thought-provoking"
                  value="thought-provoking"
                />
                <input
                  class="btn btn-sm join-item"
                  type="radio"
                  name="sentiment_<%= book[:id] %>"
                  aria-label="Moving"
                  value="moving"
                />
              </div>
            </div>
            <!-- Page input -->
            <label class="form-control">
              <div class="label">
                <span class="label-text">Page</span>
                <span class="label-text-alt opacity-70">current</span>
              </div>
              <div class="join">
                <input
                  type="number"
                  class="input input-sm input-bordered w-24 join-item"
                  min="1"
                  max="<%= total_pages %>"
                  placeholder="<%= current_page %>"
                >
                <span class="btn btn-sm join-item">/
                  <%= total_pages %></span>
              </div>
            </label>
            <!-- Actions -->
            <div class="flex flex-wrap items-center gap-3 mt-2">
              <button class="btn btn-sm btn-primary">Save update</button>
              <div class="flex-1"></div>
              <button class="btn btn-sm btn-success">Finished reading</button>
              <button class="btn btn-sm btn-error btn-outline">Dropped the book</button>
            </div>
          </form>
          <!-- Meta -->
          <div class="text-sm opacity-80">
            <p>Days reading the book:
              <strong><%= book[:days_reading] %></strong></p>
            <p>Estimated time to finish it:
              <strong><%= book[:estimated_days_to_finish] %>
                days</strong></p>
          </div>
        </div>
      </div>
    <% end %>
  </div>
</div>
